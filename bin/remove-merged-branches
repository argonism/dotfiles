#!/bin/bash


if [ -z $BRANCH ]; then
  # If branch is not specified explicitly, infer a base
  # from a whitelist of default branch names (master, main).

  for branch in master main; do
    if $(git show-ref refs/heads/$branch --quiet); then
      BRANCH=$branch
      echo Log: found branch "$branch"
      break
    fi
  done
fi


echo "Log: base branch: $BRANCH"
git branch --merged $BRANCH | grep -v $BRANCH | xargs -r git branch -d
