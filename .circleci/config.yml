version: 2
jobs:
  debian:
    docker:
      - image: circleci/python:3.6.5
        user: circleci
    steps:
      - checkout
      - run:
          name: set the name
          command: |
            export USER=circleci
      - run:
          name: install requirements
          command: |
            sudo apt-get update -y
            sudo apt-get install -y curl git make zsh ruby tmux
            wget https://github.com/neovim/neovim/releases/download/v0.3.4/nvim-linux64.tar.gz
            tar zxvf nvim-linux64.tar.gz
            sudo mv nvim-linux64/bin/nvim /usr/bin/
            pip install neovim --user
      - run:
          name: test installation
          command: |
            mkdir -p $HOME/.ssh && echo -e "Host github.com\n\tStrictHostKeyChecking no\n" > ~/.ssh/config
            bash -c "$(curl -L https://raw.githubusercontent.com/himkt/dotfiles/build-automation/bin/installer.sh)"
workflows:
  version: 2
  build_and_test:
    jobs:
      - debian


